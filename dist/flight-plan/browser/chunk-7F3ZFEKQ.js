import{c as de}from"./chunk-UGMP7KZK.js";import{a as me}from"./chunk-VSPF6BDL.js";import{a as g}from"./chunk-R26FGQ4L.js";import{a as pe}from"./chunk-47HORWFA.js";import"./chunk-CU4PJS6W.js";import{e as Y,g as ae}from"./chunk-GC3BJ3Q5.js";import{a as se}from"./chunk-JDHCJGLF.js";import{da as W,fa as K,ha as X}from"./chunk-KF2LHWVD.js";import"./chunk-F2X3VGZZ.js";import{B as J,G as Z,H as _,J as ee,K as te,L as ie,M as u,O as re,Q as ne,R as oe,Y as le,e as H,m as S,s as Q}from"./chunk-6XHS44L2.js";import{Bb as b,Cb as C,Db as $,Eb as j,Ha as D,Hb as q,Ib as B,Jb as L,Ka as s,Mb as R,N as E,Nb as a,Pa as U,T as z,Ub as G,Wa as F,Z as h,_ as y,_a as A,aa as w,ab as c,hb as T,ib as d,jb as k,kb as f,mb as V,rb as l,sb as o,tb as m,xb as O}from"./chunk-73NJSR2Q.js";var ve=["*"],he=({dt:e})=>`
.p-divider-horizontal {
    display: flex;
    width: 100%;
    position: relative;
    align-items: center;
    margin: ${e("divider.horizontal.margin")};
    padding: ${e("divider.horizontal.padding")};
}

.p-divider-horizontal:before {
    position: absolute;
    display: block;
    inset-block-start: 50%;
    inset-inline-start: 0;
    width: 100%;
    content: "";
    border-block-start: 1px solid ${e("divider.border.color")};
}

.p-divider-horizontal .p-divider-content {
    padding: ${e("divider.horizontal.content.padding")};
}

.p-divider-vertical {
    min-height: 100%;
    display: flex;
    position: relative;
    justify-content: center;
    margin: ${e("divider.vertical.margin")};
    padding: ${e("divider.vertical.padding")};
}

.p-divider-vertical:before {
    position: absolute;
    display: block;
    inset-block-start: 0;
    inset-inline-start: 50%;
    height: 100%;
    content: "";
    border-inline-start: 1px solid ${e("divider.border.color")};
}

.p-divider.p-divider-vertical .p-divider-content {
    padding: ${e("divider.vertical.content.padding")};
}

.p-divider-content {
    z-index: 1;
    background: ${e("divider.content.background")};
    color: ${e("divider.content.color")};
}

.p-divider-solid.p-divider-horizontal:before {
    border-block-start-style: solid;
}

.p-divider-solid.p-divider-vertical:before {
    border-inline-start-style: solid;
}

.p-divider-dashed.p-divider-horizontal:before {
    border-block-start-style: dashed;
}

.p-divider-dashed.p-divider-vertical:before {
    border-inline-start-style: dashed;
}

.p-divider-dotted.p-divider-horizontal:before {
    border-block-start-style: dotted;
}

.p-divider-dotted.p-divider-vertical:before {
    border-inline-start-style: dotted;
}

.p-divider-left:dir(rtl),
.p-divider-right:dir(rtl) {
    flex-direction: row-reverse;
}
`,ye={root:({props:e})=>({justifyContent:e.layout==="horizontal"?e.align==="center"||e.align===null?"center":e.align==="left"?"flex-start":e.align==="right"?"flex-end":null:null,alignItems:e.layout==="vertical"?e.align==="center"||e.align===null?"center":e.align==="top"?"flex-start":e.align==="bottom"?"flex-end":null:null})},be={root:({props:e})=>["p-divider p-component","p-divider-"+e.layout,"p-divider-"+e.type,{"p-divider-left":e.layout==="horizontal"&&(!e.align||e.align==="left")},{"p-divider-center":e.layout==="horizontal"&&e.align==="center"},{"p-divider-right":e.layout==="horizontal"&&e.align==="right"},{"p-divider-top":e.layout==="vertical"&&e.align==="top"},{"p-divider-center":e.layout==="vertical"&&(!e.align||e.align==="center")},{"p-divider-bottom":e.layout==="vertical"&&e.align==="bottom"}],content:"p-divider-content"},ce=(()=>{class e extends K{name="divider";theme=he;classes=be;inlineStyles=ye;static \u0275fac=(()=>{let r;return function(t){return(r||(r=w(e)))(t||e)}})();static \u0275prov=E({token:e,factory:e.\u0275fac})}return e})();var ue=(()=>{class e extends X{style;styleClass;layout="horizontal";type="solid";align;_componentStyle=z(ce);get hostClass(){return this.styleClass}static \u0275fac=(()=>{let r;return function(t){return(r||(r=w(e)))(t||e)}})();static \u0275cmp=F({type:e,selectors:[["p-divider"]],hostVars:33,hostBindings:function(i,t){i&2&&(T("aria-orientation",t.layout)("data-pc-name","divider")("role","separator"),V(t.hostClass),k("justify-content",t.layout==="horizontal"?t.align==="center"||t.align===void 0?"center":t.align==="left"?"flex-start":t.align==="right"?"flex-end":null:null)("align-items",t.layout==="vertical"?t.align==="center"||t.align===void 0?"center":t.align==="top"?"flex-start":t.align==="bottom"?"flex-end":null:null),f("p-divider",!0)("p-component",!0)("p-divider-horizontal",t.layout==="horizontal")("p-divider-vertical",t.layout==="vertical")("p-divider-solid",t.type==="solid")("p-divider-dashed",t.type==="dashed")("p-divider-dotted",t.type==="dotted")("p-divider-left",t.layout==="horizontal"&&(!t.align||t.align==="left"))("p-divider-center",t.layout==="horizontal"&&t.align==="center"||t.layout==="vertical"&&(!t.align||t.align==="center"))("p-divider-right",t.layout==="horizontal"&&t.align==="right")("p-divider-top",t.layout==="vertical"&&t.align==="top")("p-divider-bottom",t.layout==="vertical"&&t.align==="bottom"))},inputs:{style:"style",styleClass:"styleClass",layout:"layout",type:"type",align:"align"},features:[G([ce]),A],ngContentSelectors:ve,decls:2,vars:0,consts:[[1,"p-divider-content"]],template:function(i,t){i&1&&($(),l(0,"div",0),j(1),o())},dependencies:[S,W],encapsulation:2,changeDetection:0})}return e})();var Ce=["fileUpload"];function _e(e,n){if(e&1&&(l(0,"div",42),m(1,"p-message",43),o()),e&2){let r=C();s(),d("text",r.successMessage)}}function Pe(e,n){if(e&1&&(l(0,"div",44),m(1,"p-message",45),o()),e&2){let r=C();s(),d("text",r.errorMessage)}}function Me(e,n){e&1&&(l(0,"div",46)(1,"h3"),a(2,"Profile Picture"),o()())}function Ie(e,n){if(e&1){let r=O();l(0,"div",47)(1,"p-button",48),b("onClick",function(){h(r);let t=C();return y(t.onUploadProfilePicture())}),o(),l(2,"p-button",49),b("onClick",function(){h(r);let t=C(),p=R(16);return t.profileImageUrl=t.previousImageUrl,t.selectedFile=null,p.clear(),y(t.errorMessage="")}),o()()}if(e&2){let r=C();s(),d("loading",r.uploadInProgress)}}function Ne(e,n){e&1&&(l(0,"div",50)(1,"h3"),a(2,"Personal Information"),o()())}function xe(e,n){e&1&&(l(0,"small",51),a(1," First name is required "),o())}function Fe(e,n){e&1&&(l(0,"small",51),a(1," Last name is required "),o())}function Se(e,n){e&1&&(l(0,"small",51),a(1," Please enter a valid email address "),o())}function we(e,n){e&1&&(l(0,"small",51),a(1," Mobile number is required "),o())}var fe=class e{constructor(n,r){this.userCredentialService=n;this.http=r}profileForm=new ie({firstName:new u("",[_.required]),lastName:new u("",[_.required]),email:new u("",[_.required,_.email]),mobileNumber:new u("",[_.required]),identityNumber:new u(""),physicalAddress1:new u(""),physicalAddress2:new u(""),postalCode:new u("")});profileImageUrl="assets/images/user-profileImage.png";previousImageUrl="assets/images/user-profileImage.png";selectedFile=null;uploadInProgress=!1;saveInProgress=!1;successMessage="";errorMessage="";fileUpload;ngOnInit(){this.loadUserProfile()}loadUserProfile(){this.http.get(`${g.apiUrl}/Profile`).subscribe({next:n=>{this.profileForm.patchValue({firstName:n.firstName||"",lastName:n.surname||"",email:n.emailAddress||"",mobileNumber:n.mobileNumber||"",identityNumber:n.identityNumber||"",physicalAddress1:n.physicalAddress1||"",physicalAddress2:n.physicalAddress2||"",postalCode:n.postalCode||""}),n.profileImageUrl?(this.profileImageUrl=`${g.apiUrl}${n.profileImageUrl}`,this.previousImageUrl=this.profileImageUrl):(this.profileImageUrl="assets/images/user-profileImage.png",this.previousImageUrl=this.profileImageUrl)},error:n=>{console.error("Error loading profile:",n);let r=localStorage.getItem("userData");if(r){let i=JSON.parse(r);this.profileForm.patchValue({firstName:i.userData?.firstName||"",lastName:i.userData?.surname||"",email:i.userData?.emailAddress||"",mobileNumber:i.userData?.mobileNumber||"",identityNumber:i.userData?.identityNumber||"",physicalAddress1:i.userData?.physicalAddress1||"",physicalAddress2:i.userData?.physicalAddress2||"",postalCode:i.userData?.postalCode||""})}}})}onFileSelect(n){let r=n.files[0];if(r){if(!r.type.startsWith("image/")){this.errorMessage="Please select a valid image file.",this.fileUpload.clear();return}if(r.size>5e6){this.errorMessage="Image file size must be less than 5MB.",this.fileUpload.clear();return}this.errorMessage="",this.previousImageUrl=this.profileImageUrl,this.selectedFile=r;let i=new FileReader;i.onload=t=>{this.profileImageUrl=t.target.result},i.readAsDataURL(r)}}onUploadProfilePicture(){if(!this.selectedFile)return;this.uploadInProgress=!0,this.errorMessage="";let n=new FormData;n.append("avatar",this.selectedFile),this.http.post(`${g.apiUrl}/Profile/avatar`,n).subscribe({next:r=>{this.uploadInProgress=!1,this.selectedFile=null,this.fileUpload.clear(),r.avatarUrl&&(this.profileImageUrl=`${g.apiUrl}${r.avatarUrl}`,this.previousImageUrl=this.profileImageUrl),this.successMessage="Profile picture updated successfully!",setTimeout(()=>this.successMessage="",3e3)},error:r=>{this.uploadInProgress=!1,this.errorMessage="Failed to upload profile picture. Please try again.",console.error("Upload error:",r)}})}onSaveProfile(){if(this.profileForm.invalid){this.profileForm.markAllAsTouched();return}this.saveInProgress=!0,this.errorMessage="";let n={firstName:this.profileForm.get("firstName")?.value,surname:this.profileForm.get("lastName")?.value,emailAddress:this.profileForm.get("email")?.value,mobileNumber:this.profileForm.get("mobileNumber")?.value,identityNumber:this.profileForm.get("identityNumber")?.value,physicalAddress1:this.profileForm.get("physicalAddress1")?.value,physicalAddress2:this.profileForm.get("physicalAddress2")?.value,postalCode:this.profileForm.get("postalCode")?.value};this.http.put(`${g.apiUrl}/Profile`,n).subscribe({next:r=>{this.saveInProgress=!1,this.successMessage="Profile updated successfully!",setTimeout(()=>this.successMessage="",3e3)},error:r=>{this.saveInProgress=!1,r.error?.error?this.errorMessage=r.error.error:this.errorMessage="Failed to update profile. Please try again.",console.error("Profile update error:",r)}})}onRemoveProfilePicture(){this.errorMessage="",this.http.delete(`${g.apiUrl}/Profile/avatar`).subscribe({next:n=>{this.profileImageUrl="assets/images/user-profileImage.png",this.previousImageUrl=this.profileImageUrl,this.selectedFile=null,this.fileUpload.clear(),this.successMessage="Profile picture removed successfully!",setTimeout(()=>this.successMessage="",3e3)},error:n=>{this.errorMessage="Failed to remove profile picture. Please try again.",console.error("Profile picture removal error:",n)}})}static \u0275fac=function(r){return new(r||e)(U(me),U(Q))};static \u0275cmp=F({type:e,selectors:[["app-profile"]],viewQuery:function(r,i){if(r&1&&q(Ce,5),r&2){let t;B(t=L())&&(i.fileUpload=t.first)}},decls:76,vars:20,consts:[["fileUpload",""],[1,"profile-container"],[1,"profile-header"],["class","success-message",4,"ngIf"],["class","error-message",4,"ngIf"],[1,"profile-content"],[1,"profile-picture-card"],["pTemplate","header"],[1,"profile-picture-section"],[1,"current-picture"],["alt","Profile Picture",1,"profile-image-preview",3,"src"],[1,"picture-actions"],["mode","basic","chooseLabel","Choose Picture","accept","image/*","chooseIcon","pi pi-upload",3,"onSelect","maxFileSize","auto"],["class","picture-buttons",4,"ngIf"],["label","Remove Picture","icon","pi pi-trash","styleClass","p-button-danger p-button-outlined",3,"onClick"],[1,"profile-info-card"],[3,"ngSubmit","formGroup"],[1,"form-grid"],[1,"form-row"],[1,"form-field"],["for","firstName"],[1,"required"],["pInputText","","id","firstName","formControlName","firstName","placeholder","Enter your first name"],["class","error-text",4,"ngIf"],["for","lastName"],["pInputText","","id","lastName","formControlName","lastName","placeholder","Enter your last name"],["for","email"],["pInputText","","id","email","formControlName","email","placeholder","Enter your email address"],["for","mobileNumber"],["pInputText","","id","mobileNumber","formControlName","mobileNumber","placeholder","Enter your mobile number"],[1,"form-field","full-width"],["for","identityNumber"],["pInputText","","id","identityNumber","formControlName","identityNumber","placeholder","Enter your identity number"],["for","physicalAddress1"],["pInputText","","id","physicalAddress1","formControlName","physicalAddress1","placeholder","Enter your street address"],["for","physicalAddress2"],["pInputText","","id","physicalAddress2","formControlName","physicalAddress2","placeholder","Apartment, suite, unit, etc. (optional)"],["for","postalCode"],["pInputText","","id","postalCode","formControlName","postalCode","placeholder","Enter your postal code"],[1,"form-actions"],["type","submit","label","Save Profile","icon","pi pi-save","styleClass","p-button-primary",3,"loading"],["type","button","label","Cancel","icon","pi pi-times","routerLink","/home","styleClass","p-button-secondary"],[1,"success-message"],["severity","success",3,"text"],[1,"error-message"],["severity","error",3,"text"],[1,"profile-picture-header"],[1,"picture-buttons"],["label","Upload","icon","pi pi-check","styleClass","p-button-success",3,"onClick","loading"],["label","Cancel","icon","pi pi-times","styleClass","p-button-secondary",3,"onClick"],[1,"profile-info-header"],[1,"error-text"]],template:function(r,i){if(r&1){let t=O();l(0,"div",1)(1,"div",2)(2,"h2"),a(3,"My Profile"),o(),l(4,"p"),a(5,"Manage your account information and preferences"),o()(),c(6,_e,2,1,"div",3)(7,Pe,2,1,"div",4),l(8,"div",5)(9,"p-card",6),c(10,Me,3,0,"ng-template",7),l(11,"div",8)(12,"div",9),m(13,"img",10),o(),l(14,"div",11)(15,"p-fileUpload",12,0),b("onSelect",function(v){return h(t),y(i.onFileSelect(v))}),o(),c(17,Ie,3,1,"div",13),l(18,"p-button",14),b("onClick",function(){return h(t),y(i.onRemoveProfilePicture())}),o()()()(),m(19,"p-divider"),l(20,"p-card",15),c(21,Ne,3,0,"ng-template",7),l(22,"form",16),b("ngSubmit",function(){return h(t),y(i.onSaveProfile())}),l(23,"div",17)(24,"div",18)(25,"div",19)(26,"label",20),a(27,"First Name "),l(28,"span",21),a(29,"*"),o()(),m(30,"input",22),c(31,xe,2,0,"small",23),o(),l(32,"div",19)(33,"label",24),a(34,"Last Name "),l(35,"span",21),a(36,"*"),o()(),m(37,"input",25),c(38,Fe,2,0,"small",23),o()(),l(39,"div",18)(40,"div",19)(41,"label",26),a(42,"Email Address "),l(43,"span",21),a(44,"*"),o()(),m(45,"input",27),c(46,Se,2,0,"small",23),o(),l(47,"div",19)(48,"label",28),a(49,"Mobile Number "),l(50,"span",21),a(51,"*"),o()(),m(52,"input",29),c(53,we,2,0,"small",23),o()(),l(54,"div",18)(55,"div",30)(56,"label",31),a(57,"Identity Number"),o(),m(58,"input",32),o()(),l(59,"div",18)(60,"div",19)(61,"label",33),a(62,"Physical Address Line 1"),o(),m(63,"input",34),o(),l(64,"div",19)(65,"label",35),a(66,"Physical Address Line 2"),o(),m(67,"input",36),o()(),l(68,"div",18)(69,"div",19)(70,"label",37),a(71,"Postal Code"),o(),m(72,"input",38),o()()(),l(73,"div",39),m(74,"p-button",40)(75,"p-button",41),o()()()()()}if(r&2){let t,p,v,P,M,I,N,x;s(6),d("ngIf",i.successMessage),s(),d("ngIf",i.errorMessage),s(6),d("src",i.profileImageUrl,D),s(2),d("maxFileSize",5e6)("auto",!1),s(2),d("ngIf",i.selectedFile),s(5),d("formGroup",i.profileForm),s(8),f("ng-invalid",((t=i.profileForm.get("firstName"))==null?null:t.invalid)&&((t=i.profileForm.get("firstName"))==null?null:t.touched)),s(),d("ngIf",((p=i.profileForm.get("firstName"))==null?null:p.invalid)&&((p=i.profileForm.get("firstName"))==null?null:p.touched)),s(6),f("ng-invalid",((v=i.profileForm.get("lastName"))==null?null:v.invalid)&&((v=i.profileForm.get("lastName"))==null?null:v.touched)),s(),d("ngIf",((P=i.profileForm.get("lastName"))==null?null:P.invalid)&&((P=i.profileForm.get("lastName"))==null?null:P.touched)),s(7),f("ng-invalid",((M=i.profileForm.get("email"))==null?null:M.invalid)&&((M=i.profileForm.get("email"))==null?null:M.touched)),s(),d("ngIf",((I=i.profileForm.get("email"))==null?null:I.invalid)&&((I=i.profileForm.get("email"))==null?null:I.touched)),s(6),f("ng-invalid",((N=i.profileForm.get("mobileNumber"))==null?null:N.invalid)&&((N=i.profileForm.get("mobileNumber"))==null?null:N.touched)),s(),d("ngIf",((x=i.profileForm.get("mobileNumber"))==null?null:x.invalid)&&((x=i.profileForm.get("mobileNumber"))==null?null:x.touched)),s(21),d("loading",i.saveInProgress)}},dependencies:[S,H,le,re,Z,ee,te,ne,oe,J,ae,Y,de,pe,ue,se],styles:[".profile-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:2rem;background-color:#f8f9fa;min-height:100vh}.profile-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.profile-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;font-size:2.5rem;margin-bottom:.5rem;font-weight:600}.profile-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d;font-size:1.1rem;margin:0}.success-message[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%]{margin-bottom:1.5rem}.profile-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.profile-picture-card[_ngcontent-%COMP%], .profile-info-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 4px 6px #0000001a;overflow:hidden}.profile-picture-header[_ngcontent-%COMP%], .profile-info-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:1.5rem;margin:0}.profile-picture-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .profile-info-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:500}.profile-picture-section[_ngcontent-%COMP%]{padding:2rem;display:flex;flex-direction:column;align-items:center;gap:2rem}.current-picture[_ngcontent-%COMP%]{display:flex;justify-content:center}.current-picture[_ngcontent-%COMP%]   .profile-image-preview[_ngcontent-%COMP%]{width:150px;height:150px;border-radius:50%;object-fit:cover;border:4px solid #e9ecef;box-shadow:0 4px 12px #00000026;transition:transform .3s ease}.current-picture[_ngcontent-%COMP%]   .profile-image-preview[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.picture-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;align-items:center}.picture-actions[_ngcontent-%COMP%]   .picture-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;flex-wrap:wrap;justify-content:center}.form-grid[_ngcontent-%COMP%]{padding:2rem}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr;gap:1.5rem;margin-bottom:1.5rem}.form-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50;font-size:.9rem}.form-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#e74c3c}.form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.75rem 1rem;border:2px solid #e9ecef;border-radius:8px;font-size:1rem;transition:all .3s ease;background-color:#fff}.form-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.form-field[_ngcontent-%COMP%]   input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#e74c3c;box-shadow:0 0 0 3px #e74c3c1a}.form-field[_ngcontent-%COMP%]   .error-text[_ngcontent-%COMP%]{color:#e74c3c;font-size:.85rem;margin-top:.25rem;font-weight:500}.form-actions[_ngcontent-%COMP%]{padding:2rem;background-color:#f8f9fa;border-top:1px solid #e9ecef;display:flex;gap:1rem;justify-content:center;flex-wrap:wrap}@media (min-width: 768px){.profile-picture-section[_ngcontent-%COMP%]{flex-direction:row;justify-content:center;gap:3rem}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}@media (max-width: 768px){.profile-container[_ngcontent-%COMP%]{padding:1rem}.profile-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem}.form-actions[_ngcontent-%COMP%]{flex-direction:column}}"]})};export{fe as ProfileComponent};
